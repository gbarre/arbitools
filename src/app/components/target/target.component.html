<div class="archery-target-container">
  <svg [attr.width]="targetSize + 100" [attr.height]="targetSize + 100" [attr.viewBox]="'0 0 ' + (targetSize + 100) + ' ' + (targetSize + 100)">
    <defs>
      <!-- Filtre pour l'ombre des flèches -->
      <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
        <feDropShadow dx="1" dy="1" stdDeviation="1" flood-opacity="0.5"/>
      </filter>
    </defs>

    <!-- Groupe centré -->
    <g [attr.transform]="'translate(50, 50)'">
      <!-- Zones de la cible -->
      <g *ngFor="let zone of zones">
        <circle
          [attr.cx]="centerX"
          [attr.cy]="centerY"
          [attr.r]="zone.radius"
          [attr.fill]="zone.color"
          [attr.stroke]="zone.strokeColor"
          stroke-width="2"
        />
      </g>

      <!-- Lignes des flèches (en dessous) -->
      <g class="arrow-lines">
        <line
          *ngFor="let arrow of processedArrows; let i = index"
          [attr.x1]="arrow.x"
          [attr.y1]="arrow.y"
          [attr.x2]="getArrowLineEnd(arrow).x"
          [attr.y2]="getArrowLineEnd(arrow).y"
          [attr.stroke]="arrow.value === 0 ? '#999999' : '#1AFFA1'"
          stroke-width="3"
          stroke-linecap="round"
        />
      </g>

      <!-- Points des flèches (au-dessus) -->
      <g class="arrow-points">
        <circle
          *ngFor="let arrow of processedArrows; let i = index"
          [attr.cx]="arrow.x"
          [attr.cy]="arrow.y"
          r="4"
          [attr.fill]="arrow.value === 0 ? '#999999' : (arrow.isLate ? '#FFA500' : '#FF6B00')"
          stroke="#FFFFFF"
          stroke-width="1.5"
          filter="url(#shadow)"
          [class.arrow-point]="true"
          [class.late-arrow]="arrow.isLate"
        >
          <title>Flèche {{ i + 1 }}: {{ arrow.value }} points{{ arrow.isLate ? ' (Tardive)' : '' }}{{ arrow.spot !== undefined ? ' - Spot ' + arrow.spot : '' }}</title>
        </circle>
      </g>

      <!-- Labels des scores (optionnel) -->
      <g class="score-labels" *ngIf="false">
        <text
          *ngFor="let arrow of processedArrows; let i = index"
          [attr.x]="getArrowLineEnd(arrow).x + 5"
          [attr.y]="getArrowLineEnd(arrow).y + 5"
          font-size="12"
          font-weight="bold"
          fill="#333333"
        >
          {{ arrow.value }}
        </text>
      </g>
    </g>
  </svg>
</div>
