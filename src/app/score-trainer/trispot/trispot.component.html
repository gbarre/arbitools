
<div class="mb-3">
  <label for="disciplineSelect" class="form-label">Discipline :</label>
  <select
    id="disciplineSelect"
    class="form-select w-auto d-inline-block ms-2"
    [(ngModel)]="selectedDiscipline"
    (ngModelChange)="generate()">
    <option *ngFor="let d of disciplines" [value]="d">{{ d.replace('scores_', '') }}</option>
  </select>
</div>
<div class="card mb-4">
  <div class="card-header">
    <h5 class="card-title">
      Situation générée
      <button
        type="button"
        class="btn btn-warning float-end"
        (click)="generate()">
        Nouvelle situation
      </button>
    </h5>
  </div>
  <div class="card-body">
    <table class="table table-bordered text-center">
      <thead>
        <tr>
          <th *ngFor="let spot of [1, 2, 3]">Spot {{ spot }}</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td *ngFor="let spot of [1, 2, 3]">
            <app-target
              [discipline]="
                selectedDiscipline === 'scores_campagne' ? 'campagne' : 'standard'
              "
              [arrows]="groupedArrows[spot]"
              [size]="5"
              [targetSize]="150"
            ></app-target>
            <div *ngFor="let arrow of groupedArrows[spot]">
              <span class="badge bg-primary me-1">{{ arrow.value }}</span>
              <span
                *ngIf="arrow.isLate"
                class="badge bg-danger ms-2">
                Hors temps
                <ng-container
                  *ngIf="selectedDiscipline === 'scores_campagne'">
                  ({{ situation.lateWarningGiven ? 'déjà' : 'pas' }}
                  avertis)
                </ng-container>
              </span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<app-score-form
  [scoreForm]="scoreForm"
  [minArrowValue]="minArrowValue"
  [maxArrowValue]="maxArrowValue"
  [numArrows]="numArrows"
  (submitted)="showAnswer($event)"
></app-score-form>

<app-score-result
  *ngIf="submitted"
  [situation]="situation"
  [scoreResult]="scoreResult"
  [scoreForm]="scoreForm"
  [selectedDiscipline]="selectedDiscipline"
  [hasLateArrow]="hasLateArrow"
  [retainedArrows]="retainedArrows"
></app-score-result>
